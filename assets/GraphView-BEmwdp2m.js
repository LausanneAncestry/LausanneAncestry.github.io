import{S as ct,r as It,b as Et,i as tt,d as ft,e as Ot,f as dt,g as $t,h as zt,w as Pt,j as Z,k as Rt,c as D,a as R,o as B}from"./index-XEXB8scC.js";function H(t,n){return t==null||n==null?NaN:t<n?-1:t>n?1:t>=n?0:NaN}function Vt(t,n){return t==null||n==null?NaN:n<t?-1:n>t?1:n>=t?0:NaN}function vt(t){let n,e,r;t.length!==2?(n=H,e=(l,c)=>H(t(l),c),r=(l,c)=>t(l)-c):(n=t===H||t===Vt?t:Ct,e=t,r=t);function a(l,c,u=0,h=l.length){if(u<h){if(n(c,c)!==0)return h;do{const f=u+h>>>1;e(l[f],c)<0?u=f+1:h=f}while(u<h)}return u}function o(l,c,u=0,h=l.length){if(u<h){if(n(c,c)!==0)return h;do{const f=u+h>>>1;e(l[f],c)<=0?u=f+1:h=f}while(u<h)}return u}function i(l,c,u=0,h=l.length){const f=a(l,c,u,h-1);return f>u&&r(l[f-1],c)>-r(l[f],c)?f-1:f}return{left:a,center:i,right:o}}function Ct(){return 0}function _t(t){return t===null?NaN:+t}const Yt=vt(H),Gt=Yt.right;vt(_t).center;function Dt(t,n){let e=0,r,a=0,o=0;for(let i of t)i!=null&&(i=+i)>=i&&(r=i-a,a+=r/++e,o+=r*(i-a));if(e>1)return o/(e-1)}function Bt(t,n){const e=Dt(t);return e&&Math.sqrt(e)}class mt extends Map{constructor(n,e=Ht){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),n!=null)for(const[r,a]of n)this.set(r,a)}get(n){return super.get(ht(this,n))}has(n){return super.has(ht(this,n))}set(n,e){return super.set(Lt(this,n),e)}delete(n){return super.delete(Tt(this,n))}}function ht({_intern:t,_key:n},e){const r=n(e);return t.has(r)?t.get(r):e}function Lt({_intern:t,_key:n},e){const r=n(e);return t.has(r)?t.get(r):(t.set(r,e),e)}function Tt({_intern:t,_key:n},e){const r=n(e);return t.has(r)&&(e=t.get(r),t.delete(r)),e}function Ht(t){return t!==null&&typeof t=="object"?t.valueOf():t}const Jt=Math.sqrt(50),qt=Math.sqrt(10),Wt=Math.sqrt(2);function q(t,n,e){const r=(n-t)/Math.max(0,e),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=Jt?10:o>=qt?5:o>=Wt?2:1;let l,c,u;return a<0?(u=Math.pow(10,-a)/i,l=Math.round(t*u),c=Math.round(n*u),l/u<t&&++l,c/u>n&&--c,u=-u):(u=Math.pow(10,a)*i,l=Math.round(t/u),c=Math.round(n/u),l*u<t&&++l,c*u>n&&--c),c<l&&.5<=e&&e<2?q(t,n,e*2):[l,c,u]}function Xt(t,n,e){if(n=+n,t=+t,e=+e,!(e>0))return[];if(t===n)return[t];const r=n<t,[a,o,i]=r?q(n,t,e):q(t,n,e);if(!(o>=a))return[];const l=o-a+1,c=new Array(l);if(r)if(i<0)for(let u=0;u<l;++u)c[u]=(o-u)/-i;else for(let u=0;u<l;++u)c[u]=(o-u)*i;else if(i<0)for(let u=0;u<l;++u)c[u]=(a+u)/-i;else for(let u=0;u<l;++u)c[u]=(a+u)*i;return c}function nt(t,n,e){return n=+n,t=+t,e=+e,q(t,n,e)[2]}function Ut(t,n,e){n=+n,t=+t,e=+e;const r=n<t,a=r?nt(n,t,e):nt(t,n,e);return(r?-1:1)*(a<0?1/-a:a)}function Zt(t,n){let e=0,r=0;for(let a of t)a!=null&&(a=+a)>=a&&(++e,r+=a);if(e)return r/e}function Kt(t,n,e){t=+t,n=+n,e=(a=arguments.length)<2?(n=t,t=0,1):a<3?1:+e;for(var r=-1,a=Math.max(0,Math.ceil((n-t)/e))|0,o=new Array(a);++r<a;)o[r]=t+r*e;return o}function Qt(t){return t}var K=1,Q=2,rt=3,G=4,gt=1e-6;function tn(t){return"translate("+t+",0)"}function nn(t){return"translate(0,"+t+")"}function rn(t){return n=>+t(n)}function en(t,n){return n=Math.max(0,t.bandwidth()-n*2)/2,t.round()&&(n=Math.round(n)),e=>+t(e)+n}function an(){return!this.__axis}function jt(t,n){var e=[],r=null,a=null,o=6,i=6,l=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===K||t===G?-1:1,h=t===G||t===Q?"x":"y",f=t===K||t===rt?tn:nn;function s(d){var g=r??(n.ticks?n.ticks.apply(n,e):n.domain()),F=a??(n.tickFormat?n.tickFormat.apply(n,e):Qt),k=Math.max(o,0)+l,N=n.range(),O=+N[0]+c,M=+N[N.length-1]+c,w=(n.bandwidth?en:rn)(n.copy(),c),p=d.selection?d.selection():d,v=p.selectAll(".domain").data([null]),j=p.selectAll(".tick").data(g,n).order(),b=j.exit(),$=j.enter().append("g").attr("class","tick"),z=j.select("line"),m=j.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),j=j.merge($),z=z.merge($.append("line").attr("stroke","currentColor").attr(h+"2",u*o)),m=m.merge($.append("text").attr("fill","currentColor").attr(h,u*k).attr("dy",t===K?"0em":t===rt?"0.71em":"0.32em")),d!==p&&(v=v.transition(d),j=j.transition(d),z=z.transition(d),m=m.transition(d),b=b.transition(d).attr("opacity",gt).attr("transform",function(A){return isFinite(A=w(A))?f(A+c):this.getAttribute("transform")}),$.attr("opacity",gt).attr("transform",function(A){var x=this.parentNode.__axis;return f((x&&isFinite(x=x(A))?x:w(A))+c)})),b.remove(),v.attr("d",t===G||t===Q?i?"M"+u*i+","+O+"H"+c+"V"+M+"H"+u*i:"M"+c+","+O+"V"+M:i?"M"+O+","+u*i+"V"+c+"H"+M+"V"+u*i:"M"+O+","+c+"H"+M),j.attr("opacity",1).attr("transform",function(A){return f(w(A)+c)}),z.attr(h+"2",u*o),m.attr(h,u*k).text(F),p.filter(an).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===Q?"start":t===G?"end":"middle"),p.each(function(){this.__axis=w})}return s.scale=function(d){return arguments.length?(n=d,s):n},s.ticks=function(){return e=Array.from(arguments),s},s.tickArguments=function(d){return arguments.length?(e=d==null?[]:Array.from(d),s):e.slice()},s.tickValues=function(d){return arguments.length?(r=d==null?null:Array.from(d),s):r&&r.slice()},s.tickFormat=function(d){return arguments.length?(a=d,s):a},s.tickSize=function(d){return arguments.length?(o=i=+d,s):o},s.tickSizeInner=function(d){return arguments.length?(o=+d,s):o},s.tickSizeOuter=function(d){return arguments.length?(i=+d,s):i},s.tickPadding=function(d){return arguments.length?(l=+d,s):l},s.offset=function(d){return arguments.length?(c=+d,s):c},s}function on(t){return jt(rt,t)}function un(t){return jt(G,t)}function L(t){return typeof t=="string"?new ct([[document.querySelector(t)]],[document.documentElement]):new ct([[t]],It)}function sn(t,n){n||(n=[]);var e=t?Math.min(n.length,t.length):0,r=n.slice(),a;return function(o){for(a=0;a<e;++a)r[a]=t[a]*(1-o)+n[a]*o;return r}}function ln(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function cn(t,n){var e=n?n.length:0,r=t?Math.min(e,t.length):0,a=new Array(r),o=new Array(e),i;for(i=0;i<r;++i)a[i]=it(t[i],n[i]);for(;i<e;++i)o[i]=n[i];return function(l){for(i=0;i<r;++i)o[i]=a[i](l);return o}}function fn(t,n){var e=new Date;return t=+t,n=+n,function(r){return e.setTime(t*(1-r)+n*r),e}}function dn(t,n){var e={},r={},a;(t===null||typeof t!="object")&&(t={}),(n===null||typeof n!="object")&&(n={});for(a in n)a in t?e[a]=it(t[a],n[a]):r[a]=n[a];return function(o){for(a in e)r[a]=e[a](o);return r}}function it(t,n){var e=typeof n,r;return n==null||e==="boolean"?Et(n):(e==="number"?tt:e==="string"?(r=dt(n))?(n=r,ft):Ot:n instanceof dt?ft:n instanceof Date?fn:ln(n)?sn:Array.isArray(n)?cn:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?dn:tt)(t,n)}function mn(t,n){return t=+t,n=+n,function(e){return Math.round(t*(1-e)+n*e)}}function hn(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function W(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,r=t.slice(0,e);return[r.length>1?r[0]+r.slice(2):r,+t.slice(e+1)]}function _(t){return t=W(Math.abs(t)),t?t[1]:NaN}function gn(t,n){return function(e,r){for(var a=e.length,o=[],i=0,l=t[0],c=0;a>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),o.push(e.substring(a-=l,a+l)),!((c+=l+1)>r));)l=t[i=(i+1)%t.length];return o.reverse().join(n)}}function pn(t){return function(n){return n.replace(/[0-9]/g,function(e){return t[+e]})}}var yn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function X(t){if(!(n=yn.exec(t)))throw new Error("invalid format: "+t);var n;return new ot({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}X.prototype=ot.prototype;function ot(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}ot.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Mn(t){t:for(var n=t.length,e=1,r=-1,a;e<n;++e)switch(t[e]){case".":r=a=e;break;case"0":r===0&&(r=e),a=e;break;default:if(!+t[e])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(a+1):t}var At;function wn(t,n){var e=W(t,n);if(!e)return t+"";var r=e[0],a=e[1],o=a-(At=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+W(t,Math.max(0,n+o-1))[0]}function pt(t,n){var e=W(t,n);if(!e)return t+"";var r=e[0],a=e[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}const yt={"%":(t,n)=>(t*100).toFixed(n),b:t=>Math.round(t).toString(2),c:t=>t+"",d:hn,e:(t,n)=>t.toExponential(n),f:(t,n)=>t.toFixed(n),g:(t,n)=>t.toPrecision(n),o:t=>Math.round(t).toString(8),p:(t,n)=>pt(t*100,n),r:pt,s:wn,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Mt(t){return t}var wt=Array.prototype.map,xt=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function xn(t){var n=t.grouping===void 0||t.thousands===void 0?Mt:gn(wt.call(t.grouping,Number),t.thousands+""),e=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",a=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Mt:pn(wt.call(t.numerals,String)),i=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"−":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f){f=X(f);var s=f.fill,d=f.align,g=f.sign,F=f.symbol,k=f.zero,N=f.width,O=f.comma,M=f.precision,w=f.trim,p=f.type;p==="n"?(O=!0,p="g"):yt[p]||(M===void 0&&(M=12),w=!0,p="g"),(k||s==="0"&&d==="=")&&(k=!0,s="0",d="=");var v=F==="$"?e:F==="#"&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",j=F==="$"?r:/[%p]/.test(p)?i:"",b=yt[p],$=/[defgprs%]/.test(p);M=M===void 0?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,M)):Math.max(0,Math.min(20,M));function z(m){var A=v,x=j,P,Y,V;if(p==="c")x=b(m)+x,m="";else{m=+m;var y=m<0||1/m<0;if(m=isNaN(m)?c:b(Math.abs(m),M),w&&(m=Mn(m)),y&&+m==0&&g!=="+"&&(y=!1),A=(y?g==="("?g:l:g==="-"||g==="("?"":g)+A,x=(p==="s"?xt[8+At/3]:"")+x+(y&&g==="("?")":""),$){for(P=-1,Y=m.length;++P<Y;)if(V=m.charCodeAt(P),48>V||V>57){x=(V===46?a+m.slice(P+1):m.slice(P))+x,m=m.slice(0,P);break}}}O&&!k&&(m=n(m,1/0));var I=A.length+m.length+x.length,E=I<N?new Array(N-I+1).join(s):"";switch(O&&k&&(m=n(E+m,E.length?N-x.length:1/0),E=""),d){case"<":m=A+m+x+E;break;case"=":m=A+E+m+x;break;case"^":m=E.slice(0,I=E.length>>1)+A+m+x+E.slice(I);break;default:m=E+A+m+x;break}return o(m)}return z.toString=function(){return f+""},z}function h(f,s){var d=u((f=X(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(_(s)/3)))*3,F=Math.pow(10,-g),k=xt[8+g/3];return function(N){return d(F*N)+k}}return{format:u,formatPrefix:h}}var T,ut,Nt;bn({thousands:",",grouping:[3],currency:["$",""]});function bn(t){return T=xn(t),ut=T.format,Nt=T.formatPrefix,T}function kn(t){return Math.max(0,-_(Math.abs(t)))}function vn(t,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_(n)/3)))*3-_(Math.abs(t)))}function jn(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,_(n)-_(t))+1}function st(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t);break}return this}const bt=Symbol("implicit");function lt(){var t=new mt,n=[],e=[],r=bt;function a(o){let i=t.get(o);if(i===void 0){if(r!==bt)return r;t.set(o,i=n.push(o)-1)}return e[i%e.length]}return a.domain=function(o){if(!arguments.length)return n.slice();n=[],t=new mt;for(const i of o)t.has(i)||t.set(i,n.push(i)-1);return a},a.range=function(o){return arguments.length?(e=Array.from(o),a):e.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.copy=function(){return lt(n,e).unknown(r)},st.apply(a,arguments),a}function St(){var t=lt().unknown(void 0),n=t.domain,e=t.range,r=0,a=1,o,i,l=!1,c=0,u=0,h=.5;delete t.unknown;function f(){var s=n().length,d=a<r,g=d?a:r,F=d?r:a;o=(F-g)/Math.max(1,s-c+u*2),l&&(o=Math.floor(o)),g+=(F-g-o*(s-c))*h,i=o*(1-c),l&&(g=Math.round(g),i=Math.round(i));var k=Kt(s).map(function(N){return g+o*N});return e(d?k.reverse():k)}return t.domain=function(s){return arguments.length?(n(s),f()):n()},t.range=function(s){return arguments.length?([r,a]=s,r=+r,a=+a,f()):[r,a]},t.rangeRound=function(s){return[r,a]=s,r=+r,a=+a,l=!0,f()},t.bandwidth=function(){return i},t.step=function(){return o},t.round=function(s){return arguments.length?(l=!!s,f()):l},t.padding=function(s){return arguments.length?(c=Math.min(1,u=+s),f()):c},t.paddingInner=function(s){return arguments.length?(c=Math.min(1,s),f()):c},t.paddingOuter=function(s){return arguments.length?(u=+s,f()):u},t.align=function(s){return arguments.length?(h=Math.max(0,Math.min(1,s)),f()):h},t.copy=function(){return St(n(),[r,a]).round(l).paddingInner(c).paddingOuter(u).align(h)},st.apply(f(),arguments)}function Ft(t){var n=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Ft(n())},t}function An(){return Ft(St.apply(null,arguments).paddingInner(1))}function Nn(t){return function(){return t}}function Sn(t){return+t}var kt=[0,1];function C(t){return t}function et(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:Nn(isNaN(n)?NaN:.5)}function Fn(t,n){var e;return t>n&&(e=t,t=n,n=e),function(r){return Math.max(t,Math.min(n,r))}}function In(t,n,e){var r=t[0],a=t[1],o=n[0],i=n[1];return a<r?(r=et(a,r),o=e(i,o)):(r=et(r,a),o=e(o,i)),function(l){return o(r(l))}}function En(t,n,e){var r=Math.min(t.length,n.length)-1,a=new Array(r),o=new Array(r),i=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++i<r;)a[i]=et(t[i],t[i+1]),o[i]=e(n[i],n[i+1]);return function(l){var c=Gt(t,l,1,r)-1;return o[c](a[c](l))}}function On(t,n){return n.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function $n(){var t=kt,n=kt,e=it,r,a,o,i=C,l,c,u;function h(){var s=Math.min(t.length,n.length);return i!==C&&(i=Fn(t[0],t[s-1])),l=s>2?En:In,c=u=null,f}function f(s){return s==null||isNaN(s=+s)?o:(c||(c=l(t.map(r),n,e)))(r(i(s)))}return f.invert=function(s){return i(a((u||(u=l(n,t.map(r),tt)))(s)))},f.domain=function(s){return arguments.length?(t=Array.from(s,Sn),h()):t.slice()},f.range=function(s){return arguments.length?(n=Array.from(s),h()):n.slice()},f.rangeRound=function(s){return n=Array.from(s),e=mn,h()},f.clamp=function(s){return arguments.length?(i=s?!0:C,h()):i!==C},f.interpolate=function(s){return arguments.length?(e=s,h()):e},f.unknown=function(s){return arguments.length?(o=s,f):o},function(s,d){return r=s,a=d,h()}}function zn(){return $n()(C,C)}function Pn(t,n,e,r){var a=Ut(t,n,e),o;switch(r=X(r??",f"),r.type){case"s":{var i=Math.max(Math.abs(t),Math.abs(n));return r.precision==null&&!isNaN(o=vn(a,i))&&(r.precision=o),Nt(r,i)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=jn(a,Math.max(Math.abs(t),Math.abs(n))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=kn(a))&&(r.precision=o-(r.type==="%")*2);break}}return ut(r)}function Rn(t){var n=t.domain;return t.ticks=function(e){var r=n();return Xt(r[0],r[r.length-1],e??10)},t.tickFormat=function(e,r){var a=n();return Pn(a[0],a[a.length-1],e??10,r)},t.nice=function(e){e==null&&(e=10);var r=n(),a=0,o=r.length-1,i=r[a],l=r[o],c,u,h=10;for(l<i&&(u=i,i=l,l=u,u=a,a=o,o=u);h-- >0;){if(u=nt(i,l,e),u===c)return r[a]=i,r[o]=l,n(r);if(u>0)i=Math.floor(i/u)*u,l=Math.ceil(l/u)*u;else if(u<0)i=Math.ceil(i*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function at(){var t=zn();return t.copy=function(){return On(t,at())},st.apply(t,arguments),Rn(t)}const Vn={class:"flex flex-col items-center"},Cn={class:"chart-container flex flex-col items-center"},_n={class:"chart-container flex flex-col items-center"},Yn={class:"chart-container flex flex-col items-center"};var J=(t=>(t.HIGHER="higher",t.IDENTICAL="identical",t.LOWER="lower",t))(J||{});const Dn=$t({__name:"GraphView",setup(t){const n=Rt("data");if(!n)throw new Error("data not provided");zt(()=>{c()}),Pt(n,()=>{c()});const e=["-1","10019"];function r(f){return f=="lower"?-1:f=="identical"?0:1}const a=Z(null),o=Z(null),i=Z(null);let l;function c(){if(!n)throw new Error("data not provided");const f=n.value.persons,s=n.value.jobs;l=Object.fromEntries(Object.values(f).map(d=>[d.id,d.withJobsMetadata(s)])),u(Object.values(l),a,"hiérarchie","Hiérarchie relative à la 1ère génération",(d,g)=>d==="chef"&&g==="travailleur"?"higher":d==="travailleur"&&g==="chef"?"lower":"identical"),u(Object.values(l),o,"durée d'apprentissage","Durée d'apprentissage relative à la 1ère génération",(d,g)=>d==="haut"&&g!=="haut"||d==="moyen"&&g==="bas"?"higher":d==="bas"&&g!=="bas"||d==="moyen"&&g==="haut"?"lower":"identical"),u(Object.values(l),i,"physicalité","Physicalité relative à la 1ère génération",(d,g)=>d==="haut"&&g!=="haut"||d==="moyen"&&g==="bas"?"higher":d==="bas"&&g!=="bas"||d==="moyen"&&g==="haut"?"lower":"identical")}function u(f,s,d,g,F){const k=new Set,N=Object.fromEntries(f.map(w=>{w.person.censusYears.forEach(b=>k.add(b));const p=w.jobsMetadata;let v=p[0].metadata[d],j=p[0].id;for(let b=1;b<p.length;b++)F(p[b].metadata[d],v)=="higher"&&(v=p[b].metadata[d],j=p[b].id);return[w.person.id,{...w,maxFeatureValue:v,maxFeatureJobId:j}]}));function O(w){if(!w.person.parentId)return!1;const p=N[w.person.parentId];return w.person.parentId!==null&&w.maxFeatureValue&&!e.includes(w.maxFeatureJobId)&&p.maxFeatureValue&&!e.includes(p.maxFeatureJobId)}const M=Object.entries(N).filter(([,w])=>O(w)).map(([,w])=>({person:w.person,firstYear:Math.min(...w.person.censusYears),featureCategoryName:F(w.maxFeatureValue,N[w.person.parentId].maxFeatureValue),jobsMetadata:w.jobsMetadata}));h(M,d,Array.from(k).sort(),g,s)}function h(f,s,d,g,F){var V;const k=(V=F.value)==null?void 0:V.parentElement;if(!k)return;const N=k.clientWidth,O=450,M={top:40,right:40,bottom:60,left:220},w=N-M.left-M.right,p=O-M.top-M.bottom,v=at().domain([1800,1900]).range([0,w]),j=An().domain(Object.values(J)).range([0,p]).padding(.5),b=L(F.value).attr("viewBox",`0 0 ${w+M.left+M.right} ${p+M.top+M.bottom}`).attr("preserveAspectRatio","xMidYMid meet");b.selectAll("*").remove();const $=b.append("g").attr("transform",`translate(${M.left},${M.top})`);$.append("g").attr("transform",`translate(0,${p})`).call(on(v).tickValues(d).tickFormat(ut("d"))),$.append("g").call(un(j)),b.append("text").attr("x",M.left+w/2).attr("y",p+M.top+45).attr("text-anchor","middle").attr("font-size",14).attr("font-weight","bold").text("Year"),b.append("text").attr("x",M.left-160).attr("y",M.top+p/2).attr("text-anchor","middle").attr("transform",`rotate(-90,${M.left-160},${M.top+p/2})`).attr("font-size",14).attr("font-weight","bold").text(g);function z(){return(Math.random()-.5)*30}function m(){return(Math.random()-.5)*30}const A=lt().domain(Object.values(J)).range(["#2ca02c","#1f77b4","#d62728"]),x=L("body").append("div").attr("class","tooltip").style("opacity",0).style("position","absolute").style("background","#fff").style("border","1px solid #bbb").style("padding","6px 12px").style("border-radius","6px").style("pointer-events","none").style("font-size","13px").style("color","#222").style("box-shadow","2px 2px 8px #ccc");$.selectAll(".person").data(f).enter().append("circle").attr("class","person").attr("cx",y=>v(y.firstYear)+m()).attr("cy",y=>j(y.featureCategoryName)+z()).attr("r",4).attr("fill",y=>A(y.featureCategoryName)).attr("stroke","#333").attr("stroke-width",1.5).style("cursor","pointer").on("mouseover",function(y,I){const E=l[I.person.parentId].jobsMetadata;x.transition().duration(150).style("opacity",1),x.html(`<strong>Emplois:</strong> ${I.jobsMetadata.map(S=>S.job).filter(S=>S!=="").join(", ")} (${I.jobsMetadata.map(S=>S.metadata[s]).filter(S=>S!=="").join(", ")})<br>
        <strong>Emplois du parent:</strong> ${E.map(S=>S.job).filter(S=>S!=="").join(", ")} (${E.map(S=>S.metadata[s]).filter(S=>S!=="").join(", ")})`).style("left",y.pageX+18+"px").style("top",y.pageY-28+"px"),L(this).attr("stroke-width",3)}).on("mousemove",function(y){x.style("left",y.pageX+18+"px").style("top",y.pageY-28+"px")}).on("mouseout",function(){x.transition().duration(200).style("opacity",0),L(this).attr("stroke-width",1.5)});function P(y){return at().domain([1,0,-1]).range(Object.values(J).map(I=>j(I)))(y)}const Y=d.map(y=>{const I=f.filter(U=>U.firstYear===y).map(U=>r(U.featureCategoryName)),E=I.length?Zt(I)??0:0,S=I.length?Bt(I)??0:0;return{year:y,mean:E,std:S}});$.selectAll(".error-bar").data(Y).enter().append("line").attr("class","error-bar").attr("x1",y=>v(y.year)).attr("x2",y=>v(y.year)).attr("y1",y=>P(y.mean-y.std)).attr("y2",y=>P(y.mean+y.std)).attr("stroke","#222").attr("stroke-width",2),$.selectAll(".mean-dot").data(Y).enter().append("circle").attr("class","mean-dot").attr("cx",y=>v(y.year)).attr("cy",y=>P(y.mean)).attr("r",6).attr("fill","#222")}return(f,s)=>(B(),D("main",Vn,[R("div",Cn,[s[0]||(s[0]=R("h2",{class:"chart-title"}," Responsabilités Professionnelles ",-1)),s[1]||(s[1]=R("h3",{class:"chart-subtitle"}," de la 2ème Génération par rapport à celles de la 1ère Génération ",-1)),(B(),D("svg",{class:"chart",ref_key:"respSvgRef",ref:a},null,512))]),R("div",_n,[s[2]||(s[2]=R("h2",{class:"chart-title"}," Durée de la Formation ",-1)),s[3]||(s[3]=R("h3",{class:"chart-subtitle"}," de la 2ème Génération par rapport à celles de la 1ère Génération ",-1)),(B(),D("svg",{class:"chart",ref_key:"trainSvgRef",ref:o},null,512))]),R("div",Yn,[s[4]||(s[4]=R("h2",{class:"chart-title"}," Physique du Travail ",-1)),s[5]||(s[5]=R("h3",{class:"chart-subtitle"}," de la 2ème Génération par rapport à celles de la 1ère Génération ",-1)),(B(),D("svg",{class:"chart",ref_key:"physSvgRef",ref:i},null,512))])]))}});export{Dn as default};
